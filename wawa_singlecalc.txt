SELECT * FROM (SELECT [_DS30].[CreditWeekDateString] AS [CreditWeekDateString],[_DS30].[DueDate] AS [DueDate],[_DS30].[TransCode] AS [TransCode],[_DS30].[ProducerLegacyID] AS [ProducerLegacyID],[_DS30].[ProducerName] AS [ProducerName],[_DS30].[Premium] AS [Premium],[_DS30].[GDCRate] AS [GDCRate],[_DS30].[SplitPct] AS [SplitPct],[_DS30].[GDC] AS [GDC],[_DS30].[PayoutRate] AS [PayoutRate],[_DS30].[CommissionRate] AS [CommissionRate],[_DS30].[GDCPayout] AS [GDCPayout],[_DS30].[Commission] AS [Commission],[_DS30].[PolicyTranType] AS [PolicyTranType],[_DS30].[ProductCarrierCode] AS [ProductCarrierCode],[_DS30].[ProductCarrierName] AS [ProductCarrierName],[_DS30].[Suffix] AS [Suffix],[_DS30].[PolicyNumber] AS [PolicyNumber],[_DS30].[ClientName] AS [ClientName],ROW_NUMBER() OVER ( ORDER BY [_DS30].[CreditWeekDateString] ASC) AS [row] FROM (SELECT [_DS30].[ProducerExtPartyID],[_DS30].[PolicyNumber],[_I1].[SecondaryProperty] AS [_Column1],[_DS30].[CreditWeekDateString],[_DS30].[DueDate],[_DS30].[TransCode],[_DS30].[ProducerLegacyID],[_DS30].[ProducerName],[_DS30].[Premium],[_DS30].[GDCRate],[_DS30].[SplitPct],[_DS30].[GDC],[_DS30].[PayoutRate],[_DS30].[CommissionRate],[_DS30].[GDCPayout],[_DS30].[Commission],[_DS30].[PolicyTranType],[_DS30].[ProductCarrierCode],[_DS30].[ProductCarrierName],[_DS30].[Suffix],[_DS30].[ClientName] FROM (SELECT [_Result231].[ExternalPartyID] AS [ProducerExtPartyID],[_Result231].[Name_] AS [Weeks],[_Result231].[SequenceNum] AS [SequenceNum],[_Result231].[AttributeId] AS [AttributeId],[_Result231].[ParentNodeExtID] AS [ParentExtPartyID],[_Result231].[ContractCode] AS [ProducerContractCode],[_Result231].[ProductCategory] AS [ProductCategory],[_Result231].[TaxId] AS [ProducerSSN],[_Result231].[ContractTypeID] AS [ContractType],[_Result231].[FullName] AS [ProducerName],[_Result231].[Weeks] AS [OriginalCreditWeek],[_Result231].[Value_] AS [Payout],[_E7].[PolicyNumber] AS [PolicyNumber],[_E7].[UDCUSIP] AS [Cusip],[_E7].[GroupName] AS [GroupName],[_E7].[GroupIdentifier] AS [GroupID],[_E7].[UDPolicySuffix] AS [Suffix],[_E7].[UDInsuredFullName] AS [ClientName],[_E7].[CommPremAmt] AS [Premium],[_E7].[PolicyPremDueDate] AS [DueDate],[_E7].[ProdManufacturerCd] AS [ProductCarrierCode],[_E8].[ManufacturerDesc] AS [ProductCarrierName],[_E6].[UDPolicyTranType] AS [PolicyTranType],[_E6].[UDLegacyProducerId] AS [ProducerLegacyID],[_E6].[UDTransCode] AS [TransCode],[_E6].[UDPreCalcPayoutRate] AS [CommissionRate],[_E6].[UDGDCPct] AS [GDCRate],[_E6].[SharePercent] AS [SplitPct],[_E1].[Value_] AS [GDC],[_E2].[Value_] AS [PayoutRate],[_E4].[Value_] AS [Commission],[_E3].[Value_] AS [GDCPayout],[_E5].[DateString] AS [CreditWeekDateString] FROM (SELECT [_Result231].[SequenceNum],[_Result231].[Weeks],[_I3].[Starting_] AS [_Column3],[_Result231].[ExternalPartyID],[_Result231].[Name_],[_Result231].[AttributeId],[_Result231].[ParentNodeExtID],[_Result231].[ContractCode],[_Result231].[ProductCategory],[_Result231].[TaxId],[_Result231].[ContractTypeID],[_Result231].[FullName],[_Result231].[Value_] FROM [_Result231] [_Result231] LEFT JOIN [Time_] [_I3] ON ([_Result231].[Weeks] = [_I3].[Name_]) AND ([_I3].[TimeID_] = N'T002') AND ([_I3].[Level_] = N'Weeks')) [_Result231] LEFT JOIN (SELECT [_E1].[SequenceNum],[_E1].[Weeks],[_E1].[Value_] FROM [_Result235] [_E1]) [_E1] ON ([_E1].[SequenceNum] = [_Result231].[SequenceNum]) AND ([_E1].[Weeks] = [_Result231].[Weeks]) LEFT JOIN (SELECT [_E2].[SequenceNum],[_E2].[Weeks],[_E2].[Value_] FROM [_Result166] [_E2]) [_E2] ON ([_E2].[SequenceNum] = [_Result231].[SequenceNum]) AND ([_E2].[Weeks] = [_Result231].[Weeks]) LEFT JOIN (SELECT [_I1].[Component] AS [_Column1],[_E3].[SequenceNum],[_E3].[Weeks],[_E3].[Value_] FROM [_Result224] [_E3] LEFT JOIN [valAttribute] [_I1] ON ([_E3].[AttributeId] = [_I1].[AttributeId])) [_E3] ON (([_E3].[_Column1] = N'GDCP') OR ([_E3].[_Column1] = N'GDCV')) AND ([_E3].[SequenceNum] = [_Result231].[SequenceNum]) AND ([_E3].[Weeks] = [_Result231].[Weeks]) LEFT JOIN (SELECT [_I2].[Component] AS [_Column2],[_E4].[SequenceNum],[_E4].[Weeks],[_E4].[Value_] FROM [_Result224] [_E4] LEFT JOIN [valAttribute] [_I2] ON ([_E4].[AttributeId] = [_I2].[AttributeId])) [_E4] ON ([_E4].[_Column2] = N'COMM') AND ([_E4].[SequenceNum] = [_Result231].[SequenceNum]) AND ([_E4].[Weeks] = [_Result231].[Weeks]) LEFT JOIN (SELECT [_E5].[Date],[_E5].[DateString] FROM [valDateString] [_E5]) [_E5] ON ([_E5].[Date] = [_Result231].[_Column3]) LEFT JOIN (SELECT [_E6].[SequenceNum],[_E6].[PolicyActivityTransID],[_E6].[UDPolicyTranType],[_E6].[UDLegacyProducerId],[_E6].[UDTransCode],[_E6].[UDPreCalcPayoutRate],[_E6].[UDGDCPct],[_E6].[SharePercent] FROM [InsurancePolicyActivityTransactionAssociation] [_E6]) [_E6] ON ([_E6].[SequenceNum] = [_Result231].[SequenceNum]) LEFT JOIN (SELECT [_E7].[PolicyActivtyTransID],[_E7].[ProdManufacturerCd],[_E7].[PolicyNumber],[_E7].[UDCUSIP],[_E7].[GroupName],[_E7].[GroupIdentifier],[_E7].[UDPolicySuffix],[_E7].[UDInsuredFullName],[_E7].[CommPremAmt],[_E7].[PolicyPremDueDate] FROM [InsurancePolicyActivityTransaction] [_E7]) [_E7] ON ([_E7].[PolicyActivtyTransID] = [_E6].[PolicyActivityTransID]) LEFT JOIN (SELECT [_E8].[ManufacturerID],[_E8].[ManufacturerDesc] FROM [valManufacturerCode] [_E8]) [_E8] ON ([_E8].[ManufacturerID] = [_E7].[ProdManufacturerCd])) [_DS30] INNER JOIN [valAttribute] [_I1] ON ([_DS30].[AttributeId] = [_I1].[AttributeId])) [_DS30] CROSS JOIN (SELECT CAST(N'08264604' AS NVARCHAR(100)) AS [paPolicyNumber]) [_E1] CROSS JOIN (SELECT CAST(N'914329' AS NVARCHAR(100)) AS [WebUser_]) [_E4] INNER JOIN (SELECT [_E2].[ChildExtPartyId],[_E2].[ChildNodeType],[_E2].[ParentExtPartyId] FROM (SELECT [_Result288].[ExternalPartyId] AS [ParentExtPartyId],[_Result288].[NodeTypeID] AS [ParentNodeType],[_Result288].[ExternalPartyId2] AS [ChildExtPartyId],[_Result288].[NodeTypeID2] AS [ChildNodeType],[_Result288].[Value_] AS [Levels] FROM (SELECT [_Result288].[ExternalPartyId],[_Result288].[NodeTypeID],[_Result288].[ExternalPartyId2],[_Result288].[NodeTypeID2],[_Result288].[Value_] FROM [_Result288] [_Result288]) [_Result288]) [_E2]) [_E2] ON ([_E2].[ChildExtPartyId] = [_DS30].[ProducerExtPartyID]) AND ([_E2].[ChildNodeType] = N'PRODUCERCONTRACT') INNER JOIN (SELECT [_E3].[ExternalPartyId],[_E3].[PayeeId] FROM (SELECT [PayeeAssociation].[PayeeId] AS [PayeeId],[PayeeAssociation].[ExternalPartyId] AS [ExternalPartyId],[PayeeAssociation].[ContractCode] AS [ContractCode],[PayeeAssociation].[PayeeRole] AS [PayeeRole] FROM (SELECT [PayeeAssociation].[RecordEffectiveDate],[PayeeAssociation].[RecordExpirationDate],[PayeeAssociation].[PayeeId],[PayeeAssociation].[ExternalPartyId],[PayeeAssociation].[ContractCode],[PayeeAssociation].[PayeeRole] FROM [PayeeAssociation] [PayeeAssociation]) [PayeeAssociation] INNER JOIN (SELECT [_E1].[ValueID],[_E1].[DateValue] FROM [cfgSystemParameter] [_E1]) [_E1] ON ([_E1].[ValueID] = N'TODAYDATE') AND ([_E1].[DateValue] >= [PayeeAssociation].[RecordEffectiveDate]) AND ([_E1].[DateValue] <= [PayeeAssociation].[RecordExpirationDate])) [_E3]) [_E3] ON ([_E3].[ExternalPartyId] = [_E2].[ParentExtPartyId]) WHERE ([_E1].[paPolicyNumber] = [_DS30].[PolicyNumber]) AND ([_E4].[WebUser_] = [_E3].[PayeeId]) AND ([_DS30].[_Column1] IS NULL)) [inner] WHERE ([inner].[row] >= 1) AND ([inner].[row] < 101)